{% extends "layout.html" %}
{% block content %}
    <h2>Stock: {{ stock.name }}</h2>
    <script>
        window.onload = function () {
            var chart = new CanvasJS.Chart("chartContainer", {
                animationEnabled: true,
                theme: "light2",
                title: {
                    text: "{{ stock.name }}"
                },
                data: [{
                    type: "line",
                    indexLabelFontSize: 16,
                    dataPoints: [
                        {y: 450},
                        {y: 414},
                        {y: 520, indexLabel: "\u2191 highest", markerColor: "red", markerType: "triangle"},
                        {y: 460},
                        {y: 450},
                        {y: 500},
                        {y: 480},
                        {y: 480},
                        {y: 410, indexLabel: "\u2193 lowest", markerColor: "DarkSlateGrey", markerType: "cross"},
                        {y: 500},
                        {y: 480},
                        {y: 510}
                    ]
                }]
            });
            chart.render();

        }
    </script>
    </head>
    <body>
    <div id="chartContainer" style="height: 300px; width: 100%;"></div>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    {% if current_user.is_authenticated %}
        <a class="btn btn-primary" href="{{ url_for('create_analysis') }}" role="button">Create Analysis</a>
    {% endif %}
    <table class="table">
        <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">Date</th>
            <th scope="col">Title</th>
            <th scope="col">Stock</th>
        </tr>
        </thead>
        <tbody>
        {% for analysis in stock.analysis %}
            <tr>
                <th scope="row">{{ analysis.id }}</th>
                <td>{{ analysis.date_posted.strftime('%Y-%m-%d') }}</td>
                <td>{{ analysis.title }}</td>
                <td>{{ analysis.stock.name }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

{% endblock content %}
